"use strict";function checkObject(e,t){return Object.prototype.toString.call(e)===t}function isString(e){return checkObject(e,"[object String]")}function Message(e,t){if(console.log(e+t),isString(e)&&isString(t))return{message:e,user:t,date:Date()};throw new Error("Message: failed to create new Message.")}function insertMessage(e,t){var n=new Message(e,t),o=document.createElement("div"),s=document.createElement("p");s.textContent="@"+n.user+" wrote:";var a=document.createElement("p");a.textContent=n.date;var r=document.createElement("small");r.appendChild(a);var i=document.createElement("blockquote");i.textContent=n.message,o.appendChild(r),o.appendChild(s),o.appendChild(i),messageboard.appendChild(o)}function microAjax(e,t){if(this.bindFunction=function(e,t){return function(){return e.apply(t,[t])}},this.stateChange=function(){4==this.request.readyState&&this.callbackFunction(this.request.responseText)},this.getRequest=function(){return window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest?new XMLHttpRequest:!1},this.postBody=arguments[2]||"",this.callbackFunction=t,this.url=e,this.request=this.getRequest(),this.request){var n=this.request;n.onreadystatechange=this.bindFunction(this.stateChange,this),""!==this.postBody?(n.open("POST",e,!0),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.setRequestHeader("Connection","close")):n.open("GET",e,!0),n.send(this.postBody)}}var submit=document.querySelector("#submitButton"),chatbox=document.querySelector("#chatbox"),body=document.body,messageboard=document.querySelector("#messageboard"),userEmail=document.querySelector("#userEmail");body.addEventListener("keydown",function(e){e=e||event,e.target===chatbox&&13===e.keyCode&&(chatbox.value.replace(/\n/g,"<br>"),e.preventDefault(),console.log(chatbox.value,userEmail.value),insertMessage(chatbox.value,userEmail.value))},!1),body.addEventListener("click",function(e){e=e||event,e.target===submit&&(e.preventDefault(),console.log(chatbox.value,userEmail.value),insertMessage(chatbox.value,userEmail.value))}),console.log(window.WebSocket?"WebSocket enabled browser.":"No WebSocket available, using AJAX longpolling");